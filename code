// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

contract SchoolGradingSystem {
    struct Student {
        string name;
        uint256 marks;
        bool exists;
    }

    mapping(address => Student) private students;
    address private teacher;

    modifier onlyTeacher() {
        require(msg.sender == teacher, "Only the teacher can perform this action");
        _;
    }

    constructor() {
        teacher = msg.sender;
    }

    function enrollStudent(address studentAddress, string memory name, uint256 initialMarks) public onlyTeacher {
        if (initialMarks > 100) {
            revert("Grade must be between 0 and 100");
        }
        if (students[studentAddress].exists) {
            revert("Student already enrolled");
        }

        students[studentAddress] = Student(name, initialMarks, true);
    }

    function updateStudentMarks(address studentAddress, uint256 newMarks) public onlyTeacher {
        if (newMarks > 100) {
            revert("Grade must be between 0 and 100");
        }
        if (!students[studentAddress].exists) {
            revert("Student not enrolled");
        }

        students[studentAddress].marks = newMarks;
    }

    function changeMarks(address studentAddress, int256 delta) public onlyTeacher {
        if (!students[studentAddress].exists) {
            revert("Student not enrolled");
        }
        int256 newMarks = int256(students[studentAddress].marks) + delta;
        if (newMarks < 0 || newMarks > 100) {
            revert("Grade must be between 0 and 100");
        }

        students[studentAddress].marks = uint256(newMarks);
        assert(students[studentAddress].marks <= 100);
    }

    function getStudent(address studentAddress) public view returns (string memory, uint256) {
        if (!students[studentAddress].exists) {
            revert("Student not enrolled");
        }
        Student memory student = students[studentAddress];
        return (student.name, student.marks);
    }
}
